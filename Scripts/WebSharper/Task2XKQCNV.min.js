(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;a=self;b=a.Task2XKQCNV=a.Task2XKQCNV||{};c=b.Dto=b.Dto||{};d=c.Book=c.Book||{};e=b.Client=b.Client||{};f=a.StartupCode$Task2XKQCNV$Client=a.StartupCode$Task2XKQCNV$Client||{};g=a.WebSharper;h=g&&g.UI;i=h&&h.Var$1;j=h&&h.Submitter;k=h&&h.View;l=g&&g.Concurrency;m=a.IntelliFactory;n=m&&m.Runtime;o=g&&g.Utils;p=g&&g.Unchecked;q=g&&g.Remoting;r=q&&q.AjaxRemotingProvider;s=g&&g.Seq;t=g&&g.DateUtil;u=h&&h.Doc;v=h&&h.AttrProxy;w=g&&g.List;x=a.Date;d.New=function(y,z,A){return{Title:y,Author:z,Published:A};};e.Main=function(){var y,z,A,B,C,D,E,F,G;y=i.Create$1(false);z=i.Create$1("");A=i.Create$1("");B=i.Create$1(a.String(e.timeNow()));C=i.Create$1("");D=i.Create$1("");E=i.Create$1(a.String(e.timeNow()));F=j.CreateOption(y.get_View());G=k.MapAsync(function(H){var I,J,K;return H!=null&&H.$==1?(I=H.$0,(J=null,l.Delay(function(){function L(N){return((((n.Curried(function(O,P,Q,R){return O(o.toSafe(P)+" "+o.toSafe(Q)+" "+o.toSafe(R));},4))(a.id))(N.Title))(N.Author))(a.String((new a.Date(N.Published)).getFullYear()));}function M(N){return((((n.Curried(function(O,P,Q,R){return O(o.toSafe(P)+" "+o.toSafe(Q)+" "+o.toSafe(R));},4))(a.id))(N.Title))(N.Author))(a.String((new a.Date(N.Published)).getFullYear()));}return p.Equals(I,false)?l.Bind((new r.New()).Async("Task2XKQCNV:Task2XKQCNV.Server.AllBooks:705854993",[]),function(N){return l.Return(s.fold(function(O,P){return O+L(P)+";; \n";},"",N));}):l.Bind((new r.New()).Async("Task2XKQCNV:Task2XKQCNV.Server.FilterBooks:710066497",[C.Get(),D.Get(),t.Parse(E.Get())]),function(N){return l.Return(s.fold(function(O,P){return O+M(P)+";; \n";},"",N));});}))):(K=null,l.Delay(function(){return l.Return("");}));},F.view);return u.Element("div",[],[u.Element("table",[v.Create("border","2"),v.Create("style","margin: auto;\n            width: 80%;\n            padding: 10px;")],w.ofSeq(s.delay(function(){var H;H=v.Create("style","padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 10px;");return s.append([u.Element("th",[H],[u.Element("h2",[],[u.TextNode("New book!")]),u.Element("table",[],[u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Author's name: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("placeholder",I)],z)])];}));}))),u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Title: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("placeholder",I)],A)])];}));}))),u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Year published: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("type","number"),v.Create("placeholder",I),v.Create("min","1900"),v.Create("max",a.String(e.timeNow()))],B)])];}));})))]),u.Button("Add",[],function(){var I;if(z.Get()===""||A.Get()==="")a.alert("You must enter a value in every option!");else{I=t.Parse(B.Get());(new r.New()).Send("Task2XKQCNV:Task2XKQCNV.Server.AddBook:4243286",[z.Get(),A.Get(),I]);a.alert("New book added!");}})])],s.delay(function(){return[u.Element("th",[H],w.ofSeq(s.delay(function(){return s.append([u.Element("h2",[],[u.TextNode("Filter by:")])],s.delay(function(){return s.append([u.Element("table",[],[u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Part of author's name: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("placeholder",I)],D)])];}));}))),u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Part of the title: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("placeholder",I)],C)])];}));}))),u.Element("tr",[],w.ofSeq(s.delay(function(){var I;I="Year published: ";return s.append([u.Element("th",[],[u.Element("h3",[],[u.TextNode(I)])])],s.delay(function(){return[u.Element("th",[],[u.Input([v.Create("type","number"),v.Create("placeholder",I),v.Create("min","1900"),v.Create("max",a.String(e.timeNow()))],E)])];}));})))])],s.delay(function(){var I,J,K;I="Disabled";J="background:#ff9696";K="filterbutton";return[u.Button(I,[v.Create("id",K),v.Create("style",J)],function(){y.Set(!y.Get());!y.Get()?(self.document.getElementById(K).innerHTML=I,self.document.getElementById(K).setAttribute("style",J)):(self.document.getElementById(K).innerHTML="Enabled",self.document.getElementById(K).setAttribute("style","background:#96ff98"));})];}));}));})))];}));}))),u.Element("hr",[],[]),u.Element("h3",[],[u.TextNode("List of books! (Make sure to Refresh!)")]),u.Button("Refresh",[],function(){F.Trigger();}),u.Element("div",[v.Create("class","jumbotron")],[u.Element("b",[],[u.TextView(G)])])]);};e.timeNow=function(){f.$cctor();return f.timeNow;};f.$cctor=function(){var y;f.$cctor=a.ignore;f.timeNow=(y=x.now(),(new x(y)).getFullYear());};}());
